// Extract search query from URL
const urlParams = new URLSearchParams(window.location.search);
const searchQuery = urlParams.get('query');
const sortOption = urlParams.get('sort');

console.log("Search Query:", searchQuery);
console.log("Sort Option:", sortOption);

// Load JSON Data
fetch('assets/car_parts_data_updated.json')
    .then(response => response.json())
    .then(partsData => {
        console.log("Data Loaded:", partsData); // Debugging Step
        
        let filteredParts = partsData.filter(part => 
            part['Part Number'].toUpperCase().includes(searchQuery.toUpperCase()) ||
            part.Description.toUpperCase().includes(searchQuery.toUpperCase()) ||
            part.Manufacturer.toUpperCase().includes(searchQuery.toUpperCase()) ||
            part.Vehicle.toUpperCase().includes(searchQuery.toUpperCase())
        );

        console.log("Filtered Parts:", filteredParts); // Debugging Step

        // Apply sorting if selected
        if (sortOption === 'manufacturer') {
            filteredParts.sort((a, b) => a.Manufacturer.localeCompare(b.Manufacturer));
        } else if (sortOption === 'description') {
            filteredParts.sort((a, b) => a.Description.localeCompare(b.Description));
        }

        const resultsContainer = document.getElementById('resultsContainer');
        resultsContainer.innerHTML = '';

        if (filteredParts.length === 0) {
            resultsContainer.innerHTML = '<p>No results found.</p>';
            return;
        }

        const ul = document.createElement('ul');
        filteredParts.forEach(part => {
            const li = document.createElement('li');
            li.innerHTML = `
                <h3>${part.Description} (${part.Manufacturer})</h3>
                <p>Part Number: ${part['Part Number']}</p>
                <p>Vehicle: ${part.Vehicle}</p>
            `;
            ul.appendChild(li);
        });
        resultsContainer.appendChild(ul);
    })
    .catch(error => {
        document.getElementById('resultsContainer').innerHTML = '<p>Error loading results.</p>';
        console.error('Error:', error);
    });


